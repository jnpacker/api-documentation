{
  "kind": "InfraEnv",
  "apiVersion": "agent-install.openshift.io/v1beta1",
  "metadata": {
    "group": "agent-install.openshift.io",
    "version": "v1beta1",
    "plural": "infraenvs",
    "singular": "infraenv",
    "scope": "Namespaced"
  },
  "spec": {
    "description": "",
    "fields": {
      "additionalNTPSources": {
        "type": "array",
        "description": "AdditionalNTPSources is a list of NTP sources (hostname or IP) to be added to all cluster\nhosts. They are added to any NTP sources that were configured through other means."
      },
      "additionalTrustBundle": {
        "type": "string",
        "description": "PEM-encoded X.509 certificate bundle. Hosts discovered by this\ninfra-env will trust the certificates in this bundle. Clusters formed\nfrom the hosts discovered by this infra-env will also trust the\ncertificates in this bundle."
      },
      "agentLabels": {
        "type": "object",
        "description": "AgentLabels lists labels to apply to Agents that are associated with this InfraEnv upon\nthe creation of the Agents."
      },
      "clusterRef": {
        "type": "object",
        "description": "ClusterRef is the reference to the single ClusterDeployment that will be installed from\nthis InfraEnv.\nFuture versions will allow for multiple ClusterDeployments and this reference will be\nremoved.",
        "fields": {
          "name": {
            "type": "string",
            "description": "Name is unique within a namespace to reference a cluster resource."
          },
          "namespace": {
            "type": "string",
            "description": "Namespace defines the space within which the cluster name must be unique."
          }
        }
      },
      "cpuArchitecture": {
        "type": "string",
        "description": "CpuArchitecture specifies the target CPU architecture. Default is x86_64",
        "default": "x86_64"
      },
      "ignitionConfigOverride": {
        "type": "string",
        "description": "Json formatted string containing the user overrides for the initial ignition config"
      },
      "imageType": {
        "type": "string",
        "description": "ImageType specifies the type of discovery ISO to be generated by the Assisted Installer.\nSupported values include:\n- full-iso: A complete Red Hat CoreOS (RHCOS) ISO, customized with a specific ignition file.\n- minimal-iso: A lightweight ISO that retrieves the remainder of the RHCOS root file system (rootfs) dynamically from the Internet"
      },
      "ipxeScriptType": {
        "type": "string",
        "description": "IPXEScriptType the script type that should be served (DiscoveryImageAlways/BootOrderControl)\nDiscoveryImageAlways: Boot unconditionaly from the network discovery image\nBootOrderControl: Boot from discovery ISO depending on the host's state.\nWhen the value is BootOrderControl, the service will look for an Agent record that matches the host's MAC address;\nif found, and if that Agent is in a state where it is provisioned and attached to a cluster, then host will boot the host disk.\nOtherwise it will boot the discovery ISO using the same script as the DiscoveryImageAlways option.",
        "enum": [
          "",
          "DiscoveryImageAlways",
          "BootOrderControl"
        ],
        "default": "DiscoveryImageAlways"
      },
      "kernelArguments": {
        "type": "array",
        "description": "KernelArguments is the additional kernel arguments to be passed during boot time of the discovery image.\nApplicable for both iPXE, and ISO streaming from Image Service.",
        "fields": {
          "operation": {
            "type": "string",
            "description": "Operation is the operation to apply on the kernel argument.",
            "enum": [
              "append",
              "replace",
              "delete"
            ]
          },
          "value": {
            "type": "string",
            "description": "Value can have the form <parameter> or <parameter>=<value>. The following examples should be supported:\nrd.net.timeout.carrier=60\nisolcpus=1,2,10-20,100-2000:2/25\nquiet",
            "validations": {
              "pattern": "^(?:(?:[^ \\t\\n\\r\"]+)|(?:\"[^\"]*\"))+$"
            }
          }
        }
      },
      "mirrorRegistryRef": {
        "type": "object",
        "description": "MirrorRegistryRef is a reference to a given MirrorRegistry ConfigMap that holds the registries toml data",
        "fields": {
          "name": {
            "type": "string",
            "description": "Name is the name of the ConfigMap that this refers to",
            "required": true
          },
          "namespace": {
            "type": "string",
            "description": "Namespace of the ConfigMap",
            "required": true
          }
        }
      },
      "nmStateConfigLabelSelector": {
        "type": "object",
        "description": "NmstateConfigLabelSelector associates NMStateConfigs for hosts that are considered part\nof this installation environment.",
        "fields": {
          "matchExpressions": {
            "type": "array",
            "description": "matchExpressions is a list of label selector requirements. The requirements are ANDed.",
            "fields": {
              "key": {
                "type": "string",
                "description": "key is the label key that the selector applies to.",
                "required": true
              },
              "operator": {
                "type": "string",
                "description": "operator represents a key's relationship to a set of values.\nValid operators are In, NotIn, Exists and DoesNotExist.",
                "required": true
              },
              "values": {
                "type": "array",
                "description": "values is an array of string values. If the operator is In or NotIn,\nthe values array must be non-empty. If the operator is Exists or DoesNotExist,\nthe values array must be empty. This array is replaced during a strategic\nmerge patch."
              }
            }
          },
          "matchLabels": {
            "type": "object",
            "description": "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels\nmap is equivalent to an element of matchExpressions, whose key field is \"key\", the\noperator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
          }
        }
      },
      "osImageVersion": {
        "type": "string",
        "description": "OSImageVersion is the version of OS image to use when generating the InfraEnv.\nThe version should refer to an OSImage specified in the AgentServiceConfig\n(i.e. OSImageVersion should equal to an OpenshiftVersion in OSImages list).\nNote: OSImageVersion can't be specified along with ClusterRef."
      },
      "proxy": {
        "type": "object",
        "description": "Proxy defines the proxy settings for agents and clusters that use the InfraEnv. If\nunset, the agents and clusters will not be configured to use a proxy.",
        "fields": {
          "httpProxy": {
            "type": "string",
            "description": "HTTPProxy is the URL of the proxy for HTTP requests."
          },
          "httpsProxy": {
            "type": "string",
            "description": "HTTPSProxy is the URL of the proxy for HTTPS requests."
          },
          "noProxy": {
            "type": "string",
            "description": "NoProxy is a comma-separated list of domains and CIDRs for which the proxy should not be\nused."
          }
        }
      },
      "pullSecretRef": {
        "type": "object",
        "description": "PullSecretRef is the reference to the secret to use when pulling images.",
        "required": true,
        "fields": {
          "name": {
            "type": "string",
            "description": "Name of the referent.\nMore info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names"
          }
        }
      },
      "sshAuthorizedKey": {
        "type": "string",
        "description": "SSHAuthorizedKey is a SSH public keys that will be added to all agents for use in debugging."
      }
    }
  },
  "status": {
    "description": "",
    "fields": {
      "agentLabelSelector": {
        "type": "object",
        "description": "AgentLabelSelector specifies the label that will be applied to Agents that boot from the\ninstallation media of this InfraEnv. This is how a user would identify which agents are\nassociated with a particular InfraEnv.",
        "fields": {
          "matchExpressions": {
            "type": "array",
            "description": "matchExpressions is a list of label selector requirements. The requirements are ANDed.",
            "fields": {
              "key": {
                "type": "string",
                "description": "key is the label key that the selector applies to.",
                "required": true
              },
              "operator": {
                "type": "string",
                "description": "operator represents a key's relationship to a set of values.\nValid operators are In, NotIn, Exists and DoesNotExist.",
                "required": true
              },
              "values": {
                "type": "array",
                "description": "values is an array of string values. If the operator is In or NotIn,\nthe values array must be non-empty. If the operator is Exists or DoesNotExist,\nthe values array must be empty. This array is replaced during a strategic\nmerge patch."
              }
            }
          },
          "matchLabels": {
            "type": "object",
            "description": "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels\nmap is equivalent to an element of matchExpressions, whose key field is \"key\", the\noperator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
          }
        }
      },
      "bootArtifacts": {
        "type": "object",
        "description": "BootArtifacts specifies the URLs for each boot artifact",
        "fields": {
          "discoveryIgnitionURL": {
            "type": "string",
            "description": "DiscoveryIgnitionURL specifies an HTTP/S URL that contains the discovery ignition"
          },
          "initrd": {
            "type": "string",
            "description": "InitrdURL specifies an HTTP/S URL that contains the initrd"
          },
          "ipxeScript": {
            "type": "string",
            "description": "IpxeScriptURL specifies an HTTP/S URL that contains the iPXE script"
          },
          "kernel": {
            "type": "string",
            "description": "KernelURL specifies an HTTP/S URL that contains the kernel"
          },
          "rootfs": {
            "type": "string",
            "description": "RootfsURL specifies an HTTP/S URL that contains the rootfs"
          }
        }
      },
      "conditions": {
        "type": "array",
        "description": "No description provided.",
        "fields": {
          "lastHeartbeatTime": {
            "type": "string",
            "description": "No description provided."
          },
          "lastTransitionTime": {
            "type": "string",
            "description": "No description provided."
          },
          "message": {
            "type": "string",
            "description": "No description provided."
          },
          "reason": {
            "type": "string",
            "description": "No description provided."
          },
          "status": {
            "type": "string",
            "description": "No description provided.",
            "required": true
          },
          "type": {
            "type": "string",
            "description": "ConditionType is the state of the operator's reconciliation functionality.",
            "required": true
          }
        }
      },
      "createdTime": {
        "type": "string",
        "description": "No description provided."
      },
      "debugInfo": {
        "type": "object",
        "description": "InfraEnvDebugInfo includes information for debugging the installation process.",
        "fields": {
          "eventsURL": {
            "type": "string",
            "description": "EventsURL specifies an HTTP/S URL that contains InfraEnv events"
          },
          "staticNetworkDownloadURL": {
            "type": "string",
            "description": "StaticNetworkDownloadURL specifies an HTTP/S URL that contains the static network config"
          }
        }
      },
      "isoDownloadURL": {
        "type": "string",
        "description": "ISODownloadURL specifies an HTTP/S URL that contains a discovery ISO containing the\nconfiguration from this InfraEnv."
      }
    }
  },
  "exampleYAML": "apiVersion: agent-install.openshift.io/v1beta1\nkind: InfraEnv\nmetadata:\n  name: example-infraenv\n  namespace: default\nspec:\n  pullSecretRef: {}\n"
}